<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.32">
    <meta name="keywords" content="scratch,Scratch,少儿编程,编程,思维,教程,教育,学习"><script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?104260b4abdf491461f2e4360a755ff4";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();</script><title>重复执行与屏幕刷新 | Scratch 3 学习手册</title><meta name="description" content="时光不语，静待花开。">
    <link rel="modulepreload" href="/assets/app.bf2ec61c.js"><link rel="modulepreload" href="/assets/inner-working-3.html.374ec3c7.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/inner-working-3.html.46cae788.js">
    <link rel="stylesheet" href="/assets/style.b5235dab.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo-light.png" alt="Scratch 3 学习手册"><span class="site-name can-hide">Scratch 3 学习手册</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/" class="" aria-label="软件介绍"><!--[--><!--]--> 软件介绍 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/interface.html" class="" aria-label="软件操作"><!--[--><!--]--> 软件操作 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/code/base/" class="" aria-label="基础类型"><!--[--><!--]--> 基础类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/extend/" class="" aria-label="扩展类型"><!--[--><!--]--> 扩展类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/talk/" class="router-link-active" aria-label="指令杂谈"><!--[--><!--]--> 指令杂谈 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/practice/explain/" class="" aria-label="练习说明"><!--[--><!--]--> 练习说明 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/practice/example/primary.html" class="" aria-label="练习案例"><!--[--><!--]--> 练习案例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/support/" class="" aria-label="支持"><!--[--><!--]--> 支持 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/" class="" aria-label="软件介绍"><!--[--><!--]--> 软件介绍 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/interface.html" class="" aria-label="软件操作"><!--[--><!--]--> 软件操作 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/code/base/" class="" aria-label="基础类型"><!--[--><!--]--> 基础类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/extend/" class="" aria-label="扩展类型"><!--[--><!--]--> 扩展类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/talk/" class="router-link-active" aria-label="指令杂谈"><!--[--><!--]--> 指令杂谈 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/practice/explain/" class="" aria-label="练习说明"><!--[--><!--]--> 练习说明 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/practice/example/primary.html" class="" aria-label="练习案例"><!--[--><!--]--> 练习案例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/support/" class="" aria-label="支持"><!--[--><!--]--> 支持 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading">基础类型 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/base/" class="sidebar-item" aria-label="指令"><!--[--><!--]--> 指令 <!--[--><!--]--></a><!----></li><li><a href="/code/base/motion.html" class="sidebar-item" aria-label="运动"><!--[--><!--]--> 运动 <!--[--><!--]--></a><!----></li><li><a href="/code/base/looks.html" class="sidebar-item" aria-label="外观"><!--[--><!--]--> 外观 <!--[--><!--]--></a><!----></li><li><a href="/code/base/sound.html" class="sidebar-item" aria-label="声音"><!--[--><!--]--> 声音 <!--[--><!--]--></a><!----></li><li><a href="/code/base/events.html" class="sidebar-item" aria-label="事件"><!--[--><!--]--> 事件 <!--[--><!--]--></a><!----></li><li><a href="/code/base/control.html" class="sidebar-item" aria-label="控制"><!--[--><!--]--> 控制 <!--[--><!--]--></a><!----></li><li><a href="/code/base/sensing.html" class="sidebar-item" aria-label="侦测"><!--[--><!--]--> 侦测 <!--[--><!--]--></a><!----></li><li><a href="/code/base/operators.html" class="sidebar-item" aria-label="运算"><!--[--><!--]--> 运算 <!--[--><!--]--></a><!----></li><li><a href="/code/base/variables.html" class="sidebar-item" aria-label="变量"><!--[--><!--]--> 变量 <!--[--><!--]--></a><!----></li><li><a href="/code/base/my-blocks.html" class="sidebar-item" aria-label="自制积木"><!--[--><!--]--> 自制积木 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p class="sidebar-item sidebar-heading">扩展类型 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/extend/" class="sidebar-item" aria-label="简介"><!--[--><!--]--> 简介 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/music.html" class="sidebar-item" aria-label="音乐"><!--[--><!--]--> 音乐 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/pen.html" class="sidebar-item" aria-label="画笔"><!--[--><!--]--> 画笔 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/video-sensing.html" class="sidebar-item" aria-label="视频侦测"><!--[--><!--]--> 视频侦测 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/text-to-speech.html" class="sidebar-item" aria-label="文字朗读"><!--[--><!--]--> 文字朗读 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/translate.html" class="sidebar-item" aria-label="翻译"><!--[--><!--]--> 翻译 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p class="sidebar-item sidebar-heading active">指令杂谈 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/talk/" class="router-link-active sidebar-item" aria-label="相同事件的启动顺序"><!--[--><!--]--> 相同事件的启动顺序 <!--[--><!--]--></a><!----></li><li><a href="/code/talk/inner-working-2.html" class="sidebar-item" aria-label="执行队列的运行规则"><!--[--><!--]--> 执行队列的运行规则 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/code/talk/inner-working-3.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="重复执行与屏幕刷新"><!--[--><!--]--> 重复执行与屏幕刷新 <!--[--><!--]--></a><!----></li><li><a href="/code/talk/inner-working-4.html" class="sidebar-item" aria-label="自制积木与屏幕刷新"><!--[--><!--]--> 自制积木与屏幕刷新 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="重复执行与屏幕刷新" tabindex="-1"><a class="header-anchor" href="#重复执行与屏幕刷新" aria-hidden="true">#</a> 重复执行与屏幕刷新</h1><p>Scratch中多个指令串的运行规则，它会依照事件积木的启动顺序执行，并在多个指令串的暂停点之间来回切换（绿色表示正在执行，黄色表示等待执行）。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/10/xd1SPC.png" alt=""></p><p>接下来请你继续思考，为什么重复执行积木的最后会有一个暂停点？</p><p>要回答这个问题，你首先需要了解一下Scratch中舞台的刷新机制。</p><p>我在之前的教程中讲解角色的造型时说过，你在舞台上所看见的动画效果，实际上是利用一张张静止的图片连续播放而成。当舞台从一张图片变为另一种图片时，我们就称舞台完成了一次刷新。为了保证人所看见的动画效果不会出现卡顿，必须对舞台每秒钟的刷新次数做一个限制。</p><p>动画中的一张图片也被称为“一帧”，每秒钟刷新的次数也被称为<a href="https://zh.wikipedia.org/wiki/%E5%B8%A7%E7%8E%87" target="_blank" rel="noopener noreferrer">帧率<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>。</p><p>通常情况下，要保证动画不会出现明显卡顿，帧率必须至少为30帧/秒，这也正是Scratch中舞台的刷新帧率。也就是说1秒钟内，Scratch会对舞台完成30次刷新。简单的计算一下就知道，舞台每次刷新的时间是，1秒÷30次≈0.033秒/次。</p><p>接下来，请你完成一个小实验，测试一下当你使用重复执行积木让角色在舞台上移动时，每一次重复执行需要花费多少时间？</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/13/0mIPB4.png" alt=""></p><p>你会发现每一次重复执行的时间正好约等于0.033秒。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/13/m7FdJu.png" alt=""></p><p>也就是说，Scratch会在执行一次重复执行时，<strong>完成一次舞台的刷新</strong>，并将时间控制在0.033秒。如此一来，就能保证舞台的刷新帧率为30帧/秒。</p><p>现在请你注意看我上面这段话中“<strong>完成一次舞台的刷新</strong>”这几个字，脑子里面有没有冒出什么疑惑。</p><ol><li>舞台什么时候需要刷新？以及舞台什么时候执行刷新？</li><li>如果舞台不需要刷新，完成一次重复执行的时间还是0.033秒吗？</li></ol><p>接下来，我们就从第一个疑惑开始解答。舞台什么时候需要刷新？</p><p>我想请你先回答一个问题。如果你在舞台上添加了一个角色。但是你没有使用积木块去改变它的位置、方向、造型、大小、特效、层级，或者也没有让它说话、思考，舞台的背景也一直保持不变。这时候舞台会出现变化吗？</p><p>根据上面的判断标准，你就可以把Scratch中的积木块分为两类。</p><p>第一类，在使用的过程中，不会造成舞台发生变化，例如控制分类中的条件判断、运算积木中的数学运算积木等，这时舞台就不需要被刷新。你可以给这类积木取个名字，叫做“<strong>不刷新积木</strong>”。</p><p>第二类，在使用的过程中，会造成舞台发生改变，例如运动分类中修改坐标和方向的积木，外观分类中修改造型、大小、特效积木等，这时舞台就需要被刷新。你同样可以把这类积木取个名字，叫做“<strong>刷新积木</strong>”。</p><p>接着，请你将Scratch想象成为一个人，它的手中拿着一个小本本和一支笔。在程序执行的过程中，它会观察你使用了哪些积木块。如果你使用的是“不刷新积木”，本子上就会写上“不用刷新”；如果你使用的是“刷新积木”，本子上就会写上“需要刷新”。最后根据本子上所写的内容，Scratch就可以知道是否需要对舞台进行刷新了。</p><p>接下来需要考虑的是，Scratch什么时候会去执行刷新？</p><p>Scratch什么时候执行刷新，与指令运行的规则相关。</p><p>首先来看看下面两个指令串。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/gydOUM.png" alt=""></p><p>如果单独运行左边的指令串，里面使用了“刷新积木”。根据运行规则所有积木会在执行队列中一次性执行完成，这时舞台只会执行一次刷新。你从舞台上看见的效果就是，角色只移动了一次，并且切换了一次造型。</p><p>如果单独执行右边的指令串，同样使用了“刷新积木”。每执行一次重复，程序就会到达暂停点，这时程序就会对舞台进行一次刷新。你从舞台上看见的效果就是，角色会同时移动和切换造型，总共重复执行3次。</p><p>现在请你思考下面这两个指令串，如果点击舞台上方的绿旗按钮，舞台会如何刷新？</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/T6LE4A.png" alt=""></p><p>具体的执行过程如下：</p><p>点击绿旗按钮后，执行队列会加入两个事件。</p><ol><li>事件一重复执行第1次，运行下一个造型，到达暂停点，事件一暂停。此时舞台不刷新。</li><li>事件二重复执行第1次，运行移动10步，到达暂停点，事件二暂停。</li></ol><p>此时执行队列中的所有事件到达暂停点，程序完成一轮操作，Scratch对舞台进行第一次刷新（同时切换角色的造型和移动10步）。</p><ol start="3"><li>事件一重复执行第2次，运行下一个造型，达到暂停点，事件一暂停。此时舞台不刷新。</li><li>事件二重复执行第2次，运行移动10步，达到暂停点，事件二暂停。</li></ol><p>此时执行队列中的所有事件再次到达暂停点，程序完成第二轮操作，Scratch对舞台进行第二次刷新（同时切换角色的造型和移动10步）。</p><ol start="5"><li>事件一重复执行第3次，运行下一个造型，到达暂停点，事件一暂停。此时舞台不刷新。</li><li>事件二重复执行第3次，运行移动10步，到达暂停点，事件二暂停。</li></ol><p>此时执行队列中的所有事件再次到达暂停点，程序完成第三轮操作，Scratch对舞台进行第三次刷新（同时切换角色的造型和移动10步）。</p><p>最终你从舞台上看见的效果就是，角色同时切换造型和移动10步，总共重复执行了3次。</p><p>为了便于看清上面描述的效果，你还可以在两个<a href="/code/base/control.html#%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C-10-%E6%AC%A1-1" class="">重复执行(3)次</a>积木中各增加一个<a href="/code/base/control.html#%E7%AD%89%E5%BE%85-1-%E7%A7%92-1" class="">等待(1)秒</a>积木。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/axsrFQ.png" alt=""></p><p>以上我们就解答了第一个疑惑。你如果在一轮操作中使用了“刷新积木”，Scratch就会在该轮操作完成时，对舞台进行一次刷新。</p><p>接下来，我们继续来解答第二个疑惑。如果舞台不需要刷新，完成一次重复执行的时间还是0.033秒吗？</p><p>你可以把最开始用来测试重复执行时间的指令串修改一下，删除会造成舞台刷新的运动积木，然后运行指令重新测试。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/VL0wCk.png" alt=""></p><p>你会发现列表中的数据全部都是0，也就是说每一次重复执行都没有花费时间。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/jYVbc0.png" alt=""></p><p>类似的测试，你还可以换成下图的指令来做对比。增加一个计数器变量显示在舞台上，然后单独执行图中的其中一个指令串，观察计数器变量的增加速度有什么区别？</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/t6TmrB.png" alt=""></p><p>你会看见单独执行左边的指令串时，<strong>计数器的数值增加的比较慢</strong>。</p><p>这是因为左边的指令串中使用了“刷新积木”，每完成一次重复，就要对舞台进行一次刷新。每次刷新的时间是0.033秒，所以1秒内计数器的变量值只会增加30。</p><p>单独执行右边的指令串时，<strong>计数器的数字增加的非常快</strong>。</p><p>这是因为右边的指令串中使用的是“不刷新积木”，每次重复执行不再受到0.033秒的时间限制，所以计数器就会以1秒几万次的运行速度增加。</p><p>以上，也就解答了上面的第二个疑惑，如果舞台不需要刷新时，完成一次重复执行的时间会远远小于0.033秒。</p><p>现在两个疑惑已经解答，我想请你继续来思考一个问题。</p><p>还是利用上面的两个指令串，再增加一个变量计数器2，用来替换右边指令串中的变量。现在当你点击舞台上方的绿旗按钮时，两个计数器增加速度会是下面三个选项中的哪一个？</p><ol><li>计数器1增加慢，计数器2增加快</li><li>计数器1和2都慢速增加</li><li>计数器1和2都快速增加</li></ol><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/hnvFDN.png" alt=""></p><p>测试以后你会发现，答案是第2个选项，计数器1和2都慢速增加。</p><p>具体的执行过程类似于下面这样：</p><ol><li>事件一重复执行第1次，运行移动10步，检测碰到边缘就反弹，计数器1增加1，数值变为1，达到暂停点，事件一暂停。此时舞台不刷新。</li><li>事件二重复执行第1次，计数器2增加1，数值变为1，达到暂停点，事件二暂停。</li></ol><p>此时执行队列中的所有事件到达暂停点，完成第1轮操作。因为该轮事件一中使用了“刷新积木”，Scratch对舞台进行第1轮刷新。</p><ol start="3"><li>事件一重复执行第2次，运行移动10步，检测碰到边缘就反弹，计数器增加1，数值变为2，达到暂停点，事件一暂停。此时舞台不刷新。</li><li>事件二重复执行第2次，计数器2增加1，数值变为2，达到暂停点，事件二暂停。</li></ol><p>此时执行队列中的所有事件到达暂停点，完成第2轮操作。因为该轮事件一中使用了“刷新积木”，Scratch对舞台进行第2轮刷新。</p><ol start="5"><li>不停的重复以上两步。</li></ol><p><strong>你可以将上述操作想象为，Scratch在开始执行一轮操作时，会先在小本本中写上“不用刷新”，然后开始监测这一轮中所有需要运行的积木块。如果其中包含了一个“刷新积木”（即使该积木并没有真正让舞台发生改变），Scratch就会将小本本中的“不用刷新”改为“需要刷新”。当这轮操作结束时，Scratch会根据小本本上记录的内容，决定是否对舞台执行刷新。</strong></p><p>在上面这段描述中，有两点需要你注意：</p><ol><li><p>Scratch在判断是否需要刷新时，会对执行队列中的所有指令串，在某一轮中所有需要运行的积木块进行判断，只要其中包含一个“刷新积木”，所有指令串在本轮都会按照0.033秒的时间运行。</p></li><li><p>使用的“刷新积木”即使没有造成舞台发生改变，Scratch也会在小本本中写成“需要刷新”，从而在该轮结束时执行刷新操作。</p></li></ol><p>关于第1点，在刚刚的实验中已经验证。关于第2点，你可以使用下图的指令进行实验。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/GA3ess.png" alt=""></p><p>点击绿旗按钮后，角色的坐标并没有发生改变，所以舞台不会发生任何改变。但是计数器的数值依然是缓慢增加。</p><p>最后，关于指令对屏幕刷新的影响，还有一个特殊的积木，<a href="/code/base/looks.html#%E9%9A%90%E8%97%8F" class="">隐藏</a>积木。</p><p>在介绍<a href="/code/base/looks.html#%E9%9A%90%E8%97%8F" class="">隐藏</a>积木和虚像特效的区别时，我打过一个比方。</p><p>使用虚像积木让角色消失时，就像是给角色穿上了一件隐身衣，虽然我们看不见它，但是角色还是会停留在舞台上。这时指令串中如果使用了“刷新积木”，Scratch依然会执行刷新操作。</p><p>使用<a href="/code/base/looks.html#%E9%9A%90%E8%97%8F" class="">隐藏</a>积木让角色消失时，就像是把角色从舞台中删除。既然角色都被删除了，该角色所使用的“刷新积木”也就不再生效，Scratch也就不再执行刷新操作。</p><p>你可以单独执行下图中的两个指令串进行验证。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/Wjy42O.png" alt=""></p><p>到此为止，我们就回答了为什么重复执行积木的最后会有一个暂停点？</p><p>Scratch为了保证动画的流程性，将舞台的帧率设置为30帧/秒。具体执行的过程中，它会对程序中使用的积木进行判断。如果执行队列在一轮操作中使用了“刷新积木”，它就会对舞台完成一次刷新操作。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: ">lanheixingkong</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/code/talk/inner-working-2.html" class="" aria-label="执行队列的运行规则"><!--[--><!--]--> 执行队列的运行规则 <!--[--><!--]--></a></span><span class="next"><a href="/code/talk/inner-working-4.html" class="" aria-label="自制积木与屏幕刷新"><!--[--><!--]--> 自制积木与屏幕刷新 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.bf2ec61c.js" defer></script>
  </body>
</html>
