<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.32">
    <meta name="keywords" content="scratch,Scratch,少儿编程,编程,思维,教程,教育,学习"><script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?104260b4abdf491461f2e4360a755ff4";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();</script><title>自制积木与屏幕刷新 | Scratch 3 学习手册</title><meta name="description" content="时光不语，静待花开。">
    <link rel="modulepreload" href="/assets/app.bf2ec61c.js"><link rel="modulepreload" href="/assets/inner-working-4.html.7200dc1a.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/inner-working-4.html.f89a7ee4.js">
    <link rel="stylesheet" href="/assets/style.b5235dab.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo-light.png" alt="Scratch 3 学习手册"><span class="site-name can-hide">Scratch 3 学习手册</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/" class="" aria-label="软件介绍"><!--[--><!--]--> 软件介绍 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/interface.html" class="" aria-label="软件操作"><!--[--><!--]--> 软件操作 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/code/base/" class="" aria-label="基础类型"><!--[--><!--]--> 基础类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/extend/" class="" aria-label="扩展类型"><!--[--><!--]--> 扩展类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/talk/" class="router-link-active" aria-label="指令杂谈"><!--[--><!--]--> 指令杂谈 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/practice/explain/" class="" aria-label="练习说明"><!--[--><!--]--> 练习说明 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/practice/example/primary.html" class="" aria-label="练习案例"><!--[--><!--]--> 练习案例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/support/" class="" aria-label="支持"><!--[--><!--]--> 支持 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="软件使用"><span class="title">软件使用</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/" class="" aria-label="软件介绍"><!--[--><!--]--> 软件介绍 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/interface.html" class="" aria-label="软件操作"><!--[--><!--]--> 软件操作 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="积木介绍"><span class="title">积木介绍</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/code/base/" class="" aria-label="基础类型"><!--[--><!--]--> 基础类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/extend/" class="" aria-label="扩展类型"><!--[--><!--]--> 扩展类型 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/code/talk/" class="router-link-active" aria-label="指令杂谈"><!--[--><!--]--> 指令杂谈 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="项目练习"><span class="title">项目练习</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/practice/explain/" class="" aria-label="练习说明"><!--[--><!--]--> 练习说明 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/practice/example/primary.html" class="" aria-label="练习案例"><!--[--><!--]--> 练习案例 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/support/" class="" aria-label="支持"><!--[--><!--]--> 支持 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p class="sidebar-item sidebar-heading">基础类型 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/base/" class="sidebar-item" aria-label="指令"><!--[--><!--]--> 指令 <!--[--><!--]--></a><!----></li><li><a href="/code/base/motion.html" class="sidebar-item" aria-label="运动"><!--[--><!--]--> 运动 <!--[--><!--]--></a><!----></li><li><a href="/code/base/looks.html" class="sidebar-item" aria-label="外观"><!--[--><!--]--> 外观 <!--[--><!--]--></a><!----></li><li><a href="/code/base/sound.html" class="sidebar-item" aria-label="声音"><!--[--><!--]--> 声音 <!--[--><!--]--></a><!----></li><li><a href="/code/base/events.html" class="sidebar-item" aria-label="事件"><!--[--><!--]--> 事件 <!--[--><!--]--></a><!----></li><li><a href="/code/base/control.html" class="sidebar-item" aria-label="控制"><!--[--><!--]--> 控制 <!--[--><!--]--></a><!----></li><li><a href="/code/base/sensing.html" class="sidebar-item" aria-label="侦测"><!--[--><!--]--> 侦测 <!--[--><!--]--></a><!----></li><li><a href="/code/base/operators.html" class="sidebar-item" aria-label="运算"><!--[--><!--]--> 运算 <!--[--><!--]--></a><!----></li><li><a href="/code/base/variables.html" class="sidebar-item" aria-label="变量"><!--[--><!--]--> 变量 <!--[--><!--]--></a><!----></li><li><a href="/code/base/my-blocks.html" class="sidebar-item" aria-label="自制积木"><!--[--><!--]--> 自制积木 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p class="sidebar-item sidebar-heading">扩展类型 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/extend/" class="sidebar-item" aria-label="简介"><!--[--><!--]--> 简介 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/music.html" class="sidebar-item" aria-label="音乐"><!--[--><!--]--> 音乐 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/pen.html" class="sidebar-item" aria-label="画笔"><!--[--><!--]--> 画笔 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/video-sensing.html" class="sidebar-item" aria-label="视频侦测"><!--[--><!--]--> 视频侦测 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/text-to-speech.html" class="sidebar-item" aria-label="文字朗读"><!--[--><!--]--> 文字朗读 <!--[--><!--]--></a><!----></li><li><a href="/code/extend/translate.html" class="sidebar-item" aria-label="翻译"><!--[--><!--]--> 翻译 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p class="sidebar-item sidebar-heading active">指令杂谈 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/talk/" class="router-link-active sidebar-item" aria-label="相同事件的启动顺序"><!--[--><!--]--> 相同事件的启动顺序 <!--[--><!--]--></a><!----></li><li><a href="/code/talk/inner-working-2.html" class="sidebar-item" aria-label="执行队列的运行规则"><!--[--><!--]--> 执行队列的运行规则 <!--[--><!--]--></a><!----></li><li><a href="/code/talk/inner-working-3.html" class="sidebar-item" aria-label="重复执行与屏幕刷新"><!--[--><!--]--> 重复执行与屏幕刷新 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/code/talk/inner-working-4.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="自制积木与屏幕刷新"><!--[--><!--]--> 自制积木与屏幕刷新 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="自制积木与屏幕刷新" tabindex="-1"><a class="header-anchor" href="#自制积木与屏幕刷新" aria-hidden="true">#</a> 自制积木与屏幕刷新</h1><p>在上篇文章的最后我给你留下了一个问题，有没有什么方法可以让重复执行积木不执行刷新？</p><p>答案是，<strong>使用<a href="/code/base/my-blocks.html" class="">自制积木</a>，并且必须选中“运行时不刷新屏幕”选项。</strong></p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/14/J0LZ6F.png" alt=""></p><p>下面我们就一起来看看运行时不刷新屏幕选项具体在做些什么。</p><p>当你运行下面的指令串时，每重复执行一次，Scratch就会对舞台刷新一次。你将看见小猫从（x：-100，y：0）位置，移动10次后来到（x：0，y：0）位置。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/qVFH5m.png" alt=""></p><p>现在你可以制作一个新的积木“移动小猫”，勾选上“运行时不刷新屏幕”选项。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/7lbveg.png" alt=""></p><p>接着，将让小猫移动的指令串放入定义移动小猫积木中，变成下图的样子。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/nPZREo.png" alt=""></p><p>现在重新测试程序，你不会再看见小猫移动的过程，只能看见它停留在（x：-100，y：0）位置。</p><p>使用自制积木与不使用自制积木，程序的执行过程有什么改变？</p><p><strong>当你制作一个自制积木，并勾选上“运行时不刷新屏幕”选项后，自制积木中的暂停点就会全部被忽略，Scratch会将自制积木中的所有指令作为一个整体来执行。</strong></p><p>刚刚执行的自制积木相当于变成了下图这样。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/RK9n9E.png" alt=""></p><p>为了验证自制积木中每次重复后不会暂停，你还可以进行下面的测试。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/8o9DdS.png" alt=""></p><p>执行的过程如下：</p><ol><li>事件一开始执行，执行移动小猫积木，执行过程不会暂停，角色重复3次移动10步和加入“事件一”。此时舞台不刷新。</li><li>事件一继续执行，将“事件一终止”加入列表，程序结束。此时舞台不刷新。</li><li>事件二开始执行，执行第1次重复，将“事件二”加入列表，达到暂停点，程序暂停。</li></ol><p>此时执行队列中的所有事件到达暂停点，程序完成一轮操作，Scratch对舞台进行第一次刷新（角色向前移动30步）。</p><ol start="4"><li>事件二开始执行第2次和第3次重复，将“事件二”加入列表。</li><li>事件二继续执行，将“事件二终止”加入列表，程序结束。</li></ol><p>最终列表中的数据为下图这样。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/GwTVYw.png" alt=""></p><p>接着，将两个<a href="/code/base/events.html#%E5%BD%93%E7%BB%BF%E6%97%97%E8%A2%AB%E7%82%B9%E5%87%BB" class="">当绿旗被点击</a>积木下面的指令串交换一下位置，重新测试。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/gGwiWf.png" alt=""></p><p>执行的过程如下：</p><ol><li>左边指令开始执行，执行第1次重复，将“事件二”加入列表，到达暂停点，程序暂停。</li><li>右边指令开始执行，执行移动小猫积木，执行过程不会暂停，角色重复3次移动10步和加入“事件一”。此时舞台不刷新。</li><li>右边指令继续执行，将“事件一终止”加入列表，程序结束。</li></ol><p>此时执行队列中的所有事件到达暂停点，程序完成一轮操作，Scratch对舞台进行第一次刷新（角色向前移动30步）。</p><ol start="4"><li>事件二开始执行第2次和第3次重复，将“事件二”加入列表。</li><li>事件二继续执行，将“事件二终止”加入列表，程序结束。</li></ol><p>最终列表中的数据会是下图这样。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/Dc8aCz.png" alt=""></p><p>看完上面的执行规则，现在你的脑子里会不会出现一个新问题。</p><p>假如你在自制积木中放入了一个不会停止的<a href="/code/base/control.html#%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C-1" class="">重复执行</a>积木，Scratch会怎么办？</p><p>你可以将之前的<a href="/code/base/control.html#%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C-10-%E6%AC%A1-1" class="">重复执行(10)次</a>积木换成不会停止的<a href="/code/base/control.html#%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C-1" class="">重复执行</a>积木进行测试。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/zR7wuZ.png" alt=""></p><p>如果按照上面的规则运行，Scratch执行到移动小猫时，会一直停留在该自制积木中运行，说话积木永远无法执行。如果此时执行队列中还有其他指令串，它们也永远无法执行。舞台会停止刷新，你所看见的效果就是程序卡死，什么操作都不能执行。</p><p>为了避免上面所说的情况发生，Scratch会对上图的指令串进行一个特殊处理，<strong>强制每隔0.5秒就将自制积木中的指令暂停，并对舞台进行一次刷新。</strong></p><p>你可以利用下图中的指令串进行测试。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/4jhcBz.png" alt=""></p><p>执行的过程大致为：</p><ol><li>左边的指令串开始执行，右转30度，计算器增加1后，到达暂停点，程序停止运行。此时不刷新舞台。</li><li>右边的指令串开始执行，进入移动小猫后快速执行不会停止。</li><li>等待0.5秒，Scratch强制暂停自制积木，此时执行队列中的所有事件到达暂停点，程序完成一轮操作，Scratch对舞台进行一次刷新（角色右转30度，计数器2变量增加1，角色移动一次，计数器变量增加几万，代表了在这0.5秒内重复执行的次数）。</li><li>重复1~3步，说话积木永远无法执行。</li></ol><p>你还可以在自制积木中放入一个滑行积木测试，将滑行时间设置为1.3秒。因为滑行时间超过了0.5秒的强制刷新时间，所以你会看见小猫在舞台上移动了3次。分别是角色滑行到0.5秒、1秒和1.3秒时的位置。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/15/4fkkMr.png" alt=""></p><p>现在你已经知道了自制积木勾选上“运行时不刷新屏幕”选项后的执行规则，以后当你再定义一个自制积木时，就要避免在它下面拼接拥有暂停点的积木（<a href="/code/base/control.html#%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C-10-%E6%AC%A1-1" class="">重复执行(10)次</a>积木除外），因为它们的执行时间都可能会超过0.5秒，造成Scratch强制刷新，在舞台上出现你预料之外的效果。</p><p>最后还有一个与屏幕刷新相关的积木值得你注意，就是我们在实验中一直使用的<a href="/code/base/sensing.html#%E8%AE%A1%E6%97%B6%E5%99%A8" class="">计时器</a>积木。</p><p>从它的样子你就可以知道，<a href="/code/base/sensing.html#%E8%AE%A1%E6%97%B6%E5%99%A8" class="">计时器</a>积木只是一个变量，用来记录程序的运行时间。你有没有想过，它的变量值是如何更新呢？</p><p>你可以利用下面三个不同的指令串，分别来测试一下计时器时间的增长规律。</p><p>测试一，在重复执行中使用一个“刷新积木”。此时每重复执行一次，舞台将会刷新。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/16/YjpMnA.png" alt=""></p><p>测试结果，每重复执行一次，计时器约增长0.033秒。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/16/YRjtup.png" alt=""></p><p>测试二，删除测试一中的“刷新积木”。此时重复执行一次后，舞台不会刷新。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/16/5kjJb9.png" alt=""></p><p>测试结果，重复执行1万5千次左右，计时器约增长0.033秒。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/16/Y0rEGU.png" alt=""></p><p>第三个测试，将测试一中的重复执行积木放入自制积木中，并勾选上“运行时不刷新屏幕选项”。此时每间隔0.5秒，Scratch将强制执行一次刷新。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/16/vLoBFZ.png" alt=""></p><p>测试结果，重复执行30万次左右，计时器约增长0.5秒。</p><p><img src="https://qiniu.shenxinduo.com/shenxinduo/2023/02/16/WLCk22.png" alt=""></p><p>从以上的测试结果，你可以分析出什么结论？</p><p><strong>计时器的时间并不是随时在增长，而是当Scratch执行刷新时，进行一次更新。通常情况下，每次刷新计时器增长0.033秒。当自制积木导致强制刷新时，计时器增长0.5秒。</strong></p><p>为了验证上面的结论正不正确，你还可以自己增加其他角色和指令串进行测试。</p><p>平时你在使用并行事件完成一些功能时，经常会出现一些莫名其妙的BUG。例如我在《执行队列的运行规则》中留下的小练习。从逻辑上来看，程序似乎并没有什么问题。实际执行时，运行结果却总会与自己的预期不一致。</p><p>在Scratch没有按照你所预想的顺序执行时，就请你想一想每个执行时如何执行的，以便你能在实际开发中更快的解决问题。</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: ">lanheixingkong</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/code/talk/inner-working-3.html" class="" aria-label="重复执行与屏幕刷新"><!--[--><!--]--> 重复执行与屏幕刷新 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.bf2ec61c.js" defer></script>
  </body>
</html>
